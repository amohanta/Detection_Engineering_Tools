# =====================================================================
# OPTIMIZED: MalStringClassifier Download
# - Fast download using WebClient
# =====================================================================

$ErrorActionPreference = "SilentlyContinue"

# ===================== Configuration =====================
$destDir = "C:\tools\MalStringClassifier"
$url = "https://raw.githubusercontent.com/amohanta/Detection_Engineering_Tools/refs/heads/main/MalStringClassifier/MalStringClassifierGUI.exe"
$outFile = "$destDir\MalStringClassifierGUI.exe"

# ===================== Main Script =====================
$timer = [System.Diagnostics.Stopwatch]::StartNew()

Write-Host "=============================================" -ForegroundColor Cyan
Write-Host " MalStringClassifier Download (Optimized)" -ForegroundColor Cyan
Write-Host "=============================================" -ForegroundColor Cyan

# Create directory
New-Item -Path $destDir -ItemType Directory -Force | Out-Null

# Download using WebClient (faster than Invoke-WebRequest)
Write-Host "`n[DOWNLOAD] Downloading MalStringClassifierGUI.exe..." -ForegroundColor Cyan

try {
    $webClient = New-Object System.Net.WebClient
    $webClient.DownloadFile($url, $outFile)
    Write-Host "  OK: MalStringClassifierGUI.exe" -ForegroundColor Green
} catch {
    Write-Host "  FAILED: $($_.Exception.Message)" -ForegroundColor Red
}

# Summary
$timer.Stop()

Write-Host "`n=============================================" -ForegroundColor Green
Write-Host " Complete! Time: $([math]::Round($timer.Elapsed.TotalSeconds, 1))s" -ForegroundColor Green
Write-Host "=============================================" -ForegroundColor Green
Write-Host "  File downloaded to: $outFile"
