# Target directory
$destDir = "C:\tools\malWinAPILogger"

# Create directory if it doesn't exist
if (!(Test-Path $destDir)) {
    New-Item -ItemType Directory -Path $destDir | Out-Null
}

# Files to download
$files = @{
    "APIHook_x64.dll"            = "https://raw.githubusercontent.com/amohanta/Detection_Engineering_Tools/refs/heads/main/Mal_Win_API_Logger/APIHook_x64.dll"
    "APIHook_x86.dll"            = "https://raw.githubusercontent.com/amohanta/Detection_Engineering_Tools/refs/heads/main/Mal_Win_API_Logger/APIHook_x86.dll"
    "Mal_Win_API_Logger_x64.exe" = "https://raw.githubusercontent.com/amohanta/Detection_Engineering_Tools/refs/heads/main/Mal_Win_API_Logger/Mal_Win_API_Logger_x64.exe"
    "Mal_Win_API_Logger_x86.exe" = "https://raw.githubusercontent.com/amohanta/Detection_Engineering_Tools/refs/heads/main/Mal_Win_API_Logger/Mal_Win_API_Logger_x86.exe"
}

# Download files
foreach ($file in $files.Keys) {
    $outPath = Join-Path $destDir $file
    Invoke-WebRequest -Uri $files[$file] -OutFile $outPath -UseBasicParsing
}
