# VBA macro - XLM Macro Extractor (Excel 4.0 Macro Dumper)

This project provides a simple **VBA-based extractor** for exposing hidden **XLM macros (Excel 4.0 macros)** from malicious XLS/XLSM documents.  
Attackers often hide their payloads inside XLM macro sheets which are **not visible** in the standard VBA editor.  

## üö® Why?
- XLM macros can execute Windows commands (`=EXEC("cmd.exe /c ...")`).
- Malware authors hide them in **very hidden** sheets.
- Security researchers and malware analysts need a quick way to **dump formulas for analysis**.

## üõ†Ô∏è How it Works
- The provided VBA macro:
  - Iterates over all sheets in the workbook.
  - Checks if the sheet is a macro/XLM sheet.
  - Reads cell formulas containing XLM instructions.
  - Dumps them into a new visible worksheet for analysis.

## üìå Usage
1. Open the suspicious **XLS/XLSM** in Excel (preferably inside a sandbox or VM).
2. Press `ALT + F11` to open the **VBA editor**.
3. Insert a **new Module** and paste the provided VBA script.
4. Run the macro.  
   - It will create a new sheet with all exposed XLM formulas.

## ‚ö†Ô∏è Important
- Always run this in a **sandbox environment** (VM, offline, no network).  
- Do not enable content in a live environment.  
- This is for **malware analysis & research purposes only**.

## üì∑ Example
Hidden XLM formulas before extraction:  
