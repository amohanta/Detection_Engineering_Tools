Sub ViewSheetsFormulasAndLineNumbers()
    On Error Resume Next ' Suppress runtime errors
    Dim ws As Worksheet, rng As Range, cell As Range
    Dim i As Integer: i = 1

    For Each ws In ThisWorkbook.Sheets
        Debug.Print "Sheet " & i & ": " & ws.Name: i = i + 1
        Set rng = ws.UsedRange.SpecialCells(xlCellTypeFormulas)
        If Err.Number = 0 Then
            For Each cell In rng
                Debug.Print "  Line " & cell.Row & ", Cell " & cell.Address & ": " & cell.Formula
            Next
        Else
            Debug.Print "  No formulas in sheet: " & ws.Name
            Err.Clear ' Clear the error to avoid interference
        End If
    Next
    On Error GoTo 0 ' Re-enable error reporting
End Sub
